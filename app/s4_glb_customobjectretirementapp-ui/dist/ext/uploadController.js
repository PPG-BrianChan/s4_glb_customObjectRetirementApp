sap.ui.define(["sap/m/MessageBox","sap/m/MessageToast"],function(e,o){"use strict";function n(n,t){var r;function a(e){r&&r.getBeginButton().setEnabled(e)}function l(e){r.setBusy(e)}function s(){r&&r.close()}function i(o){e.error(o||"Upload failed")}function c(e){return sap.ui.core.Fragment.byId("uploadDialog",e)}return{onBeforeOpen:function(e){r=e.getSource();n.addDependent(r)},onAfterClose:function(e){n.removeDependent(r);r.destroy();r=undefined},onOk:function(e){l(true);var o=c("uploader");var t=new sap.ui.unified.FileUploaderParameter;var r=n._controller.extensionAPI._controller._oAppComponent.getManifestObject()._oBaseUri._string;console.log("Base URL:",r);if(!r.includes("port4004-workspaces-ws")){var a=n._controller.extensionAPI._controller._oAppComponent.getManifestObject().resolveUri("./main/excelUpload/excel");o.setUploadUrl(a);console.log("Upload URL:",a)}o.checkFileReadable().then(function(){o.upload()}).catch(function(e){i("The file cannot be read.");l(false)})},onCancel:function(e){s()},onTypeMismatch:function(e){var o=e.getSource().getFileType().map(function(e){return"*."+e}).join(", ");i("The file type *."+e.getParameter("fileType")+" is not supported. Choose one of the following types: "+o)},onFileAllowed:function(e){a(true)},onFileEmpty:function(e){a(false)},onUploadComplete:function(e){var t=e.getParameter("status");var r=e.getSource();r.clear();a(false);l(false);if(t>=400){console.log("ERROR");if(typeof e.getParameter("responseRaw")==="string"){i(e.getParameter("responseRaw"))}else{var c=JSON.parse(e.getParameter("responseRaw"));i(c&&c.error&&c.error.message)}}else{o.show("Uploaded successfully");n.refresh();s()}}}}return{showUploadDialog:function(e,o){this.loadFragment({id:"uploadDialog",name:"objectRetirementApp.s4glbcustomobjectretirementappui.ext.uploadDialog",controller:n(this)}).then(function(e){e.open()})}}});